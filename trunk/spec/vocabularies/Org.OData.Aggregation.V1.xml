<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://tinyurl.com/Org-OData-Core">
    <edmx:Include Namespace="Org.OData.Core.V1" Alias="Core" />
  </edmx:Reference>
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="Org.OData.Aggregation.V1" Alias="Aggregation">
      <Annotation Term="Core.Description">
        <String>Terms to describe which data in a given entity model can be aggregated, and how.</String>
      </Annotation>

      <Term Name="SupportsApply" Type="Aggregation.SupportsApplyType" AppliesTo="EntitySet EntityContainer">
        <Annotation Term="Core.Description">
          <String>This entity set or entity container supports the $apply system query option.</String>
        </Annotation>
      </Term>

      <ComplexType Name="SupportsApplyType">
        <Property Name="SupportsCount" DefaultValue="true" Type="Edm.Boolean">
          <Annotation Term="Core.Description" String="The virtual property $count can be used in the aggregate transformation" />
        </Property>
        <Property Name="SupportedTransformations" Nullable="true" Type="Collection(Edm.String)">
          <Annotation Term="Core.Description" String="Transformations that can be used in $apply" />
        </Property>
        <Property Name="AggregatableProperties" Nullable="true" Type="Collection(Aggregation.AggregatableProperty)">
          <Annotation Term="Core.Description" String="Properties that can be used in the aggregate transformation" />
        </Property>
        <Property Name="GroupableProperties" Nullable="true" Type="Collection(Aggregation.GroupableProperty)">
          <Annotation Term="Core.Description" String="Properties that can be used in the groupby transformation" />
        </Property>
        <Property Name="SupportsMultipleRollupHierarchies" DefaultValue="true" Type="Edm.Boolean">
          <Annotation Term="Core.Description" String="The service supports more than one rollup hierarchy in a groupby transformation" />
        </Property>
      </ComplexType>

      <ComplexType Name="AggregatableProperty">
        <Property Name="Name" Type="Edm.PropertyPath" />
        <Property Name="DefaultAggregrationFunction" Type="Edm.String" Nullable="true" />
        <Property Name="SupportedAggregrationFunctions" Type="Collection(Aggregation.SupportedAggregationFunction)" Nullable="true" />
        <Property Name="RequiredGroupingProperties" Type="Collection(Edm.PropertyPath)" Nullable="true" />
      </ComplexType>

      <ComplexType Name="SupportedAggregationFunction">
        <Property Name="Name" Type="Edm.String" />
        <Property Name="SupportedGroupingProperties" Type="Collection(Edm.PropertyPath)" Nullable="true" />
      </ComplexType>

      <ComplexType Name="GroupableProperty">
        <Property Name="Name" Type="Edm.PropertyPath" />
        <Property Name="DependentProperties" Type="Collection(Edm.PropertyPath)" Nullable="true" />
      </ComplexType>

      <Term Name="LeveledHierarchy" Type="Collection(Edm.PropertyPath)" AppliesTo="EntityType">
        <Annotation Term="Core.Description" String="Defines a leveled hierarchy by defining an ordered list of properties in the hierarchy " />
      </Term>

      <Term Name="RecursiveHierarchy" Type="Aggregation.RecursiveHierarchyType" AppliesTo="EntityType">
        <Annotation Term="Core.Description" String="Defines a recursive hierarchy." />
      </Term>

      <ComplexType Name="RecursiveHierarchyType">
        <Property Name="NodeProperty" Type="Edm.PropertyPath" Nullable="false" />
        <Property Name="ParentNodeProperty" Type="Edm.PropertyPath" Nullable="true" />
        <Property Name="HierarchyLevelProperty" Type="Edm.PropertyPath" Nullable="true" />
        <Property Name="IsLeafProperty" Type="Edm.PropertyPath" Nullable="true">
          <Annotation Term="Core.RequiresType" String="Edm.Boolean" />
        </Property>
      </ComplexType>

      <Term Name="AvailableOnAggregates" Type="Aggregation.AvailableOnAggregatesType" AppliesTo="Action Function">
        <Annotation Term="Core.Description">
          <String>This Action or Function is available on aggregated entities, as long as the RequiredProperties are still available. </String>
        </Annotation>
      </Term>

      <ComplexType Name="AvailableOnAggregatesType">
        <Property Name="RequiredProperties" Type="Collection(Edm.PropertyPath)" Nullable="false" />
      </ComplexType>

    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
