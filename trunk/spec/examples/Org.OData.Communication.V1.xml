<?xml version="1.0" encoding="utf-8"?>
<Schema xmlns="http://docs.oasis-open.org/odata/ns/csdl/4.0" Alias="Self"
  Namespace="Org.OData.Communication.V1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://docs.oasis-open.org/odata/ns/csdl/4.0 ../schemas/csdl.xsd"
>
  <Documentation>
    <Summary>
      Terms for annotating communication-relevant information inspired by
       - RFC6350 vCard (http://tools.ietf.org/html/rfc6350)
       - RFC5545 iCalendar (http://tools.ietf.org/html/rfc5545)
       - RFC5322 Internet Message Format (http://tools.ietf.org/html/rfc5322)
    </Summary>
  </Documentation>

  <Using Alias="Core" Namespace="OData.Core.V1" />

  <ValueTerm Name="Contact" Type="Self.ContactData">
    <Documentation>
      <Summary>Annotation for easy integration into address books</Summary>
    </Documentation>
    <ValueAnnotation Term="Core.AppliesToEntityType" />
  </ValueTerm>

  <ComplexType Name="ContactData">
    <Documentation>
      <Summary>Address book entry</Summary>
    </Documentation>
    <Property Name="formattedName" Type="String" Nullable="true" />
    <Property Name="givenName" Type="String" Nullable="true" />
    <Property Name="additionalName" Type="String" Nullable="true" />
    <Property Name="familyName" Type="String" Nullable="true" />
    <Property Name="nickName" Type="String" Nullable="true" />
    <Property Name="honorificPrefix" Type="String" Nullable="true" />
    <Property Name="honorificSuffix" Type="String" Nullable="true" />
    <Property Name="note" Type="String" Nullable="true" />
    <Property Name="birthDate" Type="DateTimeOffset" Nullable="true" />
    <Property Name="photoUri" Type="String" Nullable="true">
      <ValueAnnotation Term="Core.IsUri" />
    </Property>

    <Property Name="orgName" Type="String" Nullable="true" />
    <Property Name="orgUnit" Type="String" Nullable="true" />
    <Property Name="orgRole" Type="String" Nullable="true" />
    <Property Name="jobTitle" Type="String" Nullable="true" />

    <Property Name="addresses" Type="Collection(Self.Address)" Nullable="true" />
    <Property Name="phoneNumbers" Type="Collection(Self.PhoneNumber)" Nullable="true" />
    <Property Name="emailAddresses" Type="Collection(Self.EmailAddress)"
      Nullable="true" />
  </ComplexType>

  <ComplexType Name="Address">
    <Property Name="street" Type="String" Nullable="true" />
    <Property Name="locality" Type="String" Nullable="true" />
    <Property Name="region" Type="String" Nullable="true" />
    <Property Name="postalCode" Type="String" Nullable="true" />
    <Property Name="country" Type="String" Nullable="true" />
    <Property Name="poBox" Type="String" Nullable="true" />
    <Property Name="formattedAddress" Type="String" Nullable="true" />
    <Property Name="kind" Type="Collection(Self.ContactInformationKind)"
      Nullable="true" />
  </ComplexType>

  <ComplexType Name="PhoneNumber">
    <Property Name="number" Type="String" />
    <Property Name="kind" Type="Collection(Self.ContactInformationKind)"
      Nullable="true" />
  </ComplexType>

  <ComplexType Name="EmailAddress">
    <Property Name="address" Type="String" />
    <Property Name="kind" Type="Collection(Self.ContactInformationKind)"
      Nullable="true" />
  </ComplexType>

  <EnumType Name="ContactInformationKind">
    <Member Name="work"></Member>
    <Member Name="home"></Member>
    <Member Name="other"></Member>
    <Member Name="preferred"></Member>
  </EnumType>

  <ValueTerm Name="Event" Type="Self.EventData">
    <Documentation>
      <Summary>Annotation for easy integration into calendars</Summary>
    </Documentation>
    <ValueAnnotation Term="Core.AppliesToEntityType" />
  </ValueTerm>

  <ComplexType Name="EventData">
    <Documentation>
      <Summary>Calendar entry</Summary>
    </Documentation>
    <Property Name="summary" Type="String" Nullable="true" />
    <Property Name="description" Type="String" Nullable="true" />
    <Property Name="categories" Type="Collection(String)" Nullable="true" />
    <Property Name="dtstart" Type="DateTimeOffset" Nullable="true" />
    <Property Name="dtend" Type="DateTimeOffset" Nullable="true" />
    <Property Name="duration" Type="Time" Nullable="true" />
    <Property Name="class" Type="String" Nullable="true" />
    <Property Name="status" Type="String" Nullable="true" />
    <Property Name="location" Type="String" Nullable="true" />
    <Property Name="transp" Type="Boolean" Nullable="true" />
    <Property Name="wholeday" Type="Boolean" Nullable="true" />
    <Property Name="fbtype" Type="String" Nullable="true" />
  </ComplexType>

  <ValueTerm Name="Task" Type="Self.TaskData">
    <Documentation>
      <Summary>Annotation for easy integration into todo lists</Summary>
    </Documentation>
    <ValueAnnotation Term="Core.AppliesToEntityType" />
  </ValueTerm>

  <ComplexType Name="TaskData">
    <Documentation>
      <Summary>Todo list entry</Summary>
    </Documentation>
    <Property Name="summary" Type="String" Nullable="true" />
    <Property Name="description" Type="String" Nullable="true" />
    <Property Name="due" Type="DateTimeOffset" Nullable="true" />
    <Property Name="completed" Type="DateTimeOffset" Nullable="true" />
    <Property Name="percentcomplete" Type="Byte" Nullable="true" />
    <Property Name="priority" Type="Byte" Nullable="true" />
  </ComplexType>

  <ValueTerm Name="Message" Type="Self.MessageData">
    <Documentation>
      <Summary>Annotation for easy integration into messaging applications</Summary>
    </Documentation>
    <ValueAnnotation Term="Core.AppliesToEntityType" />
  </ValueTerm>

  <ComplexType Name="MessageData">
    <Documentation>
      <Summary>Message</Summary>
    </Documentation>
    <Property Name="from" Type="String" Nullable="true" />
    <Property Name="sender" Type="String" Nullable="true" />
    <Property Name="to" Type="Collection(String)" Nullable="true" />
    <Property Name="cc" Type="Collection(String)" Nullable="true" />
    <Property Name="bcc" Type="Collection(String)" Nullable="true" />
    <Property Name="subject" Type="String" Nullable="true" />
    <Property Name="body" Type="String" Nullable="true" />
    <Property Name="keywords" Type="Collection(String)" Nullable="true" />
    <Property Name="received" Type="DateTimeOffset" Nullable="true" />
  </ComplexType>

</Schema>