<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>OData TC meeting #207 Thursday March 15, 2018</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
body{-webkit-font-smoothing:antialiased;font-family:Cambria,Arial,Verdana,sans-serif;margin:0} body {margin-left:2%}
body,p,td,div{color:#111;font-family:"Helvetica Neue",Helvetica,Arial,Verdana,sans-serif;/*word-wrap:break-word*/}
h1,h2,h3,h4,h5,h6{line-height:1.5em}
a{-webkit-transition:color .2s ease-in-out;color:#0d6ea1;text-decoration:none}
a:hover{color:#3593d9}.footnote{color:#0d6ea1;font-size:.8em;vertical-align:super}dd{margin-bottom:1em}
li>p:first-child{margin:0}ul ul,ul ol{margin-bottom:.4em}.poetry
pre{display:block;font-family:Georgia,Garamond,serif!important;font-size:110%!important;font-style:italic;line-height:1.6em;margin-left:1em}
.poetry pre code{font-family:Georgia,Garamond,serif!important}
sup,sub,a.footnote{font-size:1.4ex;height:0;line-height:1;position:relative;vertical-align:super}sub{vertical-align:sub;top:-1px}
p,h5{font-size:1.1429em;line-height:1.3125em;margin:1.3125em 0}dt,th{font-weight:700}p{margin:0.7ex 2.0em}pre{margin-left:4em;}
p.note{font-size:75%}
.code-like{font-family:monospace;font-size:120%!important}
@media print{body{overflow:auto}
#wrapper{background:#fff;color:#303030;font-size:85%;padding:10px;position:relative;text-indent:0}}
@media screen{/*::selection{background:rgba(157,193,200,.5)}*/.inverted{background:#333}
.inverted p,.inverted td,.inverted li,.inverted h1,.inverted h2,.inverted h3,.inverted h4,.inverted h5,.inverted h6,.inverted pre,.inverted code,.inverted th{color:#eee!important}
.inverted a{color:#fff;text-decoration:underline}#wrapper{padding:20px}.inverted #wrapper{background:#333}}
</style>
<!-- # grep -v excluding_those_lines __file__ |shasum -a 512 -->
<!-- sha512_excluding_those_lines='227e4aed9c324425fee1ca52c1d85604217dc7dcbb8b1474bdcd77872c3579859db7de397281a4997a9029f6ac86a686f1b273fd84ad292fc99a05ad34c49257' -->
</head>
<body class="normal">
  <div id="wrapper">
<h1>OData TC meeting #207 Thursday March 15, 2018</h1>
<p>Acting chair: Mike</p>
<pre>Chat transcript from room: odatatc
2018-03-15 0800-1000 PDT
</pre>
<h2 id="1">1. Roll call</h2>

<h3 id="1.1">1.1 Members present</h3>

<pre>
    George Ericson (Dell)
    Gerald Kraue (SAP SE)
    Hubert Heijkers (IBM)
    Matthew Borges (SAP SE) a.k.a. Matt
    Michael Pizzo (Microsoft) a.k.a. Mike
    Stefan Hagen (Individual)
    Ted Jones (Red Hat)
</pre>

<p>Quorum achieved. Details cf. <a href="https://www.oasis-open.org/apps/org/workgroup/odata/event.php?event_id=46247">normative attendance sheet for this meeting (event_id=46247)</a>.</p>

<p>Notes taken by all and subsequently edited for readability by Stefan.</p>

<h2 id="2">2. Approve agenda</h2>
<p>Agenda approved unchanged as published</p>

<h2 id="3">3. Approve minutes from previous meeting(s)</h2>
<h3 id="3.1">3.1 Minutes from March 08, 2018 TC meeting #206</h3>
<p><a href="https://www.oasis-open.org/committees/download.php/62674/odata-meeting-206_on-20180308-minutes.html" rel="noopener noreferrer" target="_blank">https://www.oasis-open.org/committees/download.php/62674/odata-meeting-206_on-20180308-minutes.html</a></p>
<p>Minutes approved unchanged as published.</p>

<h2 id="4">4. Review action items [<a href="https://www.oasis-open.org/apps/org/workgroup/odata/members/action_items.php" rel="noopener noreferrer" target="_blank">Link to Action item list</a>]</h2>
<h3 id="4.1">4.1 Action items due</h3>
<p>Reviewed action items. None due; heads up on approaching deadlines.</p>


<h2 id="5">5. Issues</h2>

<h3 id="5.1">5.1 V4.01: NEW or OPEN</h3>
<h4 id="5.1.1">5.1.1 <a href="https://issues.oasis-open.org/browse/ODATA-1166" rel="noopener noreferrer" target="_blank">ODATA-1166</a> - Update JSON references to RFC8259</h4>
<p>Mike: reference to new RFC: <a href="https://tools.ietf.org/html/rfc8259" rel="noopener noreferrer" target="_blank">https://tools.ietf.org/html/rfc8259</a></p>
<p>Mike: Question: are there any updates that would affect us? From RFC8529:</p>
<pre>
Appendix A.  Changes from RFC 7159

   This section lists changes between this document and the text in
   RFC 7159.

   o  Section 1.2 has been updated to reflect the removal of a JSON
      specification from ECMA-262, to make ECMA-404 a normative
      reference, and to explain the particular meaning of "normative".

   o  Section 1.3 has been updated to reflect errata filed against
      RFC 7159, not RFC 4627.

   o  Section 8.1 was changed to require the use of UTF-8 when
      transmitted over a network.

   o  Section 12 has been updated to increase the precision of the
      description of the security risk that follows from using the
      ECMAScript "eval()" function.

   o  Section 14.1 has been updated to include ECMA-404 as a normative
      reference.

   o  Section 14.2 has been updated to remove ECMA-404, update the
      version of ECMA-262, and refresh the errata list.
</pre>
<p>Mike: Does not appear that any of these changes would have an impact on our use of JSON.</p>
<p>Mike: Note: JSON apparently requires JSON readers to support escaped forward slashes, though writers are not required to escape.  Our examples do not escape, which is fine.</p>
<p><b>Hubert</b>: I <b>move</b> to resolve ODATA-1166 as proposed. <b>Ted</b> seconds.</p>
<p>Mike: Motion approved by unanimous consent.</p>


<h4 id="5.1.2">5.1.2 <a href="https://issues.oasis-open.org/browse/ODATA-1165" rel="noopener noreferrer" target="_blank">ODATA-1165</a> - Describe $expand and $select via prose text and examples, remove ABNF snippets</h4>
<p>Mike: We will wait on ODATA-1166 until ralf can explain the overly restrictive nature of the ABNF.</p>
<p>Mike: (that is, we will wait on ODATA-1165)</p>


<h4 id="5.1.3">5.1.3 <a href="https://issues.oasis-open.org/browse/ODATA-1164" rel="noopener noreferrer" target="_blank">ODATA-1164</a> - List of use cases for canonical functions is incomplete</h4>
<p>Mike: ODATA-1164 is open</p>
<p>Mike: (btw; we did open 1166 prior to moving to approve...)</p>
<p>Mike: </p>
<pre>
5.1.1.4 Canonical Functions
In addition to operators, a set of functions is also defined for use with the $filter or 
$orderby system query options. The following sections describe the available functions. 
Note: ISNULL or COALESCE operators are not defined. Instead, OData defines a null literal 
that can be used in comparisons.
</pre>
<p>Mike: Statement should be more general, but current wording does help people understand where functions can be used.</p>
<p>Gerald: The set of functions can be used anywhere a common expression is applied such as $filter or $orderby.</p>
<p>Mike: Perhaps make the statement more specific, but include filter and orderby as examples...</p>
<p>Mike: Gerald has updated the proposal.</p>
<p><b>Hubert</b>: I <b>move</b> to resolve ODATA-1164 as per the updated proposal. <b>Matt</b> seconds.</p>
<p>Mike: ODATA-1164 is approved as proposed.</p>


<h4 id="5.1.4">5.1.4 <a href="https://issues.oasis-open.org/browse/ODATA-1163" rel="noopener noreferrer" target="_blank">ODATA-1163</a> - A Case for Common Expressions</h4>
<p>Mike: </p>
<pre>
1. Core OData: Ad-hoc calculations with logic on the current property values:

Example: Signum(x)

GET ~/XValues?$compute=case(X > 0 : 1,X &lt; 0 : -1, 0) as SignumX&amp;$select=X,SignumX

2. Data Aggregation extension: Restricting aggregation to those values that occur in combination with certain groupable property values:
Example: Comparing company revenues for years 2000 and 2017

GET ~/Sales?$apply=groupby((Company), aggregate(case(Time/Year eq 2000 : Revenue) with sum as TotalRevenue2000, case(Time/Year eq 2017 : Revenue) with sum as TotalRevenue2017))

3. Data Aggregation extension: Defining dynamic groupable properties
Example: From a collection of incidents with fine-grained state model (e.g., new, assigned, resolved, verified, reopened, closed) retrieve the aggregated count of open and closed incidents:

GET ~/Incidents?$apply=compute(case(Status eq Closed : Closed, Open) as ProcessingStatus)/groupby((ProcessingStatus), aggregate($count as IncidentCount))
</pre>
<p>Mike: RESO was asking for this just last week.</p>
<p>Mike: is case(X > 0 : 1,X &lt; 0 : -1, 0)  equivalent to if(X>0,1,if(X&lt;0,-1,0)?</p>
<p>Mike: sum is defined as returning null if there are no non-null values, so for 2017, the expression:</p>
<p>Mike: GET ~/Sales?$apply=groupby((Company), aggregate(case(Time/Year eq 2000 : Revenue) with sum as TotalRevenue2000, case(Time/Year eq 2017 : Revenue) with sum as TotalRevenue2017))</p>
<p>Mike: would be equivalent to writing:</p>
<pre>
GET ~/Sales?$apply=groupby((Company), aggregate(null, case(Time/Year eq 2017 : Revenue) with sum as TotalRevenue2017))
GET ~/Sales?$apply=groupby((Company), aggregate(null, Revenue with sum as TotalRevenue2017))
GET ~/Sales?$apply=groupby((Company), aggregate(null with sum as TotalRevenue2000, Revenue with sum as TotalRevenue2017))
</pre>
<p>Mike: (never mind above; aggregate is applying to each row in the input set...)</p>
<pre>
Would it be equally expressive to use something like if-then-else? 
Would that be more intuitive to a programmer?
Or would switch be more similar for programmers?
</pre>
<p>George: are we trying to put too much in the expressions, making it hard on services to implement?</p>
<p>Mike: </p>
<pre>
Would we need a way to tell whether services support the new expression?
(add to existing capabilities for supported canonical functions)
could be done as a custom function if(condition,value-if-true,value-if-false), 
but that would be more verbose and less standardized.
</pre>
<p>Gerald: how do we define the type of the expression result?</p>
<p>Mike: Easiest would be to force all result expressions to be of the same type.</p>
<p>Mike: Alternative would be to cast to common type; i.e., if one expression returned an integer and one a string, the type of the expression would be a string.</p>
<p>Mike:  OData 1163 is open.  Gerald will flesh out a complete proposal.</p>


<h4 id="5.1.5">5.1.5 <a href="https://issues.oasis-open.org/browse/ODATA-1154" rel="noopener noreferrer" target="_blank">ODATA-1154</a> - Clarify which OData-Version a service should return</h4>
<p>Mike: Discussed in meeting march 1st. Open questions:</p>
<p>Mike: Questions: </p>
<pre>
1) What if no OData-MaxVersion is specified? 
2) Does specifying an OData-Version limit the constructs that the request can use in the URL? 
   i.e., if I have a 4.0 payload, am I restricted to 4.0 URL constructs, even if I know the service supports them? 
3) What if the client *only* support 4.01? Do we have a way to specify NOT to return 4.0? 
4) Does a service have to return a 4.01 payload if the request uses a 4.01 construct?
</pre>
<p>Mike: The following is a legal delta payload for describing changes to a collection of customers:</p>
<pre>
{
  "value": [
    {
      "CustomerID": "EASTC",
      "CompanyName": "Eastern Connection",
      "ContactName": "Ann Devon",
      "ContactTitle": "Sales Agent"
    },
    {
      "CustomerID": "ALFKI",
      "Orders@delta": [
        {
          "OrderID": 11011,
          "CustomerID": "ALFKI",
          "EmployeeID": 3,
          "OrderDate": "1998-04-09T00:00:00Z",
          "RequiredDate": "1998-05-07T00:00:00Z",
          "ShippedDate": "1998-04-13T00:00:00Z"
        },
      ]
    }
  ]
}
</pre>
<p>Mike: This could be a delta response from an initial query of GET ~Customers, or to a PATCH Customers</p>
<p>Mike: Similarly, changes to a single item *within the customers collection*</p>
<pre>
{
  "@context":"#$delta",
  "value": [
    {
      "CustomerID": "ALFKI",
      "Orders@delta": [
        {
          "OrderID": 11011,
          "CustomerID": "ALFKI",
          "EmployeeID": 3,
          "OrderDate": "1998-04-09T00:00:00Z",
          "RequiredDate": "1998-05-07T00:00:00Z",
          "ShippedDate": "1998-04-13T00:00:00Z"
        }
      ]
    }
  ]
}
</pre>
<p>Mike: Today, we can patch an individual customer (PATCH ~Customers('ALFKI'):</p>
<pre>
{
  "@context":"#$delta",
  "CustomerID": "ALFKI",
}
</pre>
<p>Mike: I would expect you could also PATCH ~Customers('ALFKI'):</p>
<pre>
{
  "@context":"#$delta",
  "CustomerID": "ALFKI",
  "Orders@delta": [
        {
          "OrderID": 11011,
          "CustomerID": "ALFKI",
          "EmployeeID": 3,
          "OrderDate": "1998-04-09T00:00:00Z",
          "RequiredDate": "1998-05-07T00:00:00Z",
          "ShippedDate": "1998-04-13T00:00:00Z"
        }
  ]
}
</pre>
<p>Mike: (without the @context)</p>
<p>Mike: (and without the CustomerID, but you could instead change a different properties of alfki:</p>
<pre>
{
  "Name": "Bob",
  "Orders@delta": [
        {
          "OrderID": 11011,
          "CustomerID": "ALFKI",
          "EmployeeID": 3,
          "OrderDate": "1998-04-09T00:00:00Z",
          "RequiredDate": "1998-05-07T00:00:00Z",
          "ShippedDate": "1998-04-13T00:00:00Z"
        }
  ]
}
</pre>
<p>Mike: So, if I did a GET ~Customers('ALFKI')?$expand=Orders, and asked for a delta link, that delta link could return this same payload.</p>
<p>Mike: (with the addition of the context url)</p>
<p>Mike: In a response, the context url would be "@context":"#$delta"</p>
<pre>
GET ~Customers('ALFKI') = > context: ...Customers/$entity
GET ~CustomerSingleton => context: ...CustomerSingleton (with no trailing /$entity)
</pre>
<p>Mike: same thing for a single valued nav prop...</p>
<p>Mike: (strike that; Hubert points out that, for a single valued nav prop bound to a collection, the contextUrl is the bound set with /$entity)</p>

<h2 id="6">6. Next meetings</h2>
<p>Ralf:</p>
<pre>
Thursday March 22, 2018 during 8-10 am PDT (16:00-18:00 CET) – Daylight Saving Time in North America
Thursday March 29, 2018 during 8-10 am PDT (17:00-19:00 CEST) – back to normal time difference, Easter is coming
</pre>

<h2 id="7">7. AOB and wrap up</h2>
<p>None.</p>

<p>Meeting adjourned by chair.</p>
</div>
</body>
</html>
